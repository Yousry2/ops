@let treeNode = node();

@let isFolderNode = treeNode.isFolder && treeNode.children.length >0;
<div class="mt-1 block">
        <div class=" block  hover:bg-hover" [class]=`pl-${level()*4}`>

                <div (keyup.enter)="toggleExpanded()" (keyup.space)="toggleExpanded()" (click)="toggleExpanded()"
                        class="flex items-center justify-between p-2 rounded " tabindex="0"
                        [class]=" isFolderNode ? 'cursor-pointer' : ''">
                        <div class=" flex items-center ">
                                <span class=" text-nowrap ">
                                        <input id=`test-{{node().id}}` class=" mr-2 cursor-pointer text-primary"
                                                fill="currentColor" type="checkbox" [checked]="checked()"
                                                [indeterminate]="indeterminate()"
                                                (change)="toggleChecked(!checked());$event.stopPropagation()" />
                                        <label for=`test-{{node().id}}` (click)="$event.stopPropagation()"
                                                class="cursor-pointer" (keyup)="$event.stopPropagation()" tabindex=""
                                                [class]="treeNode.isFolder ? 'font-bold' : ''">
                                                {{ node().title}}
                                        </label>
                                </span>
                        </div>
                        @if(isFolderNode) {
                        <button class="chevron">
                                @if(expanded()) {
                                <span>&#11165;</span>
                                } @else {
                                <span>&#11167;</span>
                                }
                        </button>
                        }
                </div>

        </div>
        @if (treeNode.isFolder && treeNode.children.length) {
        <div class="children" [class]="expanded() ? 'children-expanded' : 'children-collapsed'">
                <div class="node">
                        @for (child of treeNode.children; track child.id) {
                        <lib-asset-node [level]="level()+1" [node]="child" #childNode />
                        }
                </div>
        </div>
        }
</div>